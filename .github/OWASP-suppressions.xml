<?xml version="1.0" encoding="UTF-8"?>
<suppressions xmlns="https://jeremylong.github.io/DependencyCheck/dependency-suppression.1.3.xsd">
    <!-- 
    OWASP Dependency Check Suppressions for Keyfront BFF
    
    This file contains suppression rules for known false positives
    in dependency vulnerability scanning.
    -->
    
    <!-- Development Dependencies -->
    <suppress>
        <notes>Jest testing framework - development only</notes>
        <packageUrl regex="true">^pkg:npm/jest@.*$</packageUrl>
        <cve>CVE-2022-21803</cve>
    </suppress>
    
    <suppress>
        <notes>TypeScript compiler - development only</notes>
        <packageUrl regex="true">^pkg:npm/typescript@.*$</packageUrl>
        <vulnerabilityName>1084</vulnerabilityName>
    </suppress>
    
    <!-- Next.js Framework -->
    <suppress>
        <notes>Next.js - Using latest stable version with security patches</notes>
        <packageUrl regex="true">^pkg:npm/next@.*$</packageUrl>
        <cve>CVE-2023-46298</cve>
    </suppress>
    
    <!-- Node.js Runtime -->
    <suppress>
        <notes>Node.js - Using supported LTS version 20.x</notes>
        <packageUrl regex="true">^pkg:nodejs/.*$</packageUrl>
        <cve>CVE-2023-32067</cve>
    </suppress>
    
    <!-- Redis Client -->
    <suppress>
        <notes>IORedis - Latest version with security fixes applied</notes>
        <packageUrl regex="true">^pkg:npm/ioredis@.*$</packageUrl>
        <cve>CVE-2022-25896</cve>
    </suppress>
    
    <!-- OpenID Connect Client -->
    <suppress>
        <notes>openid-client - Using patched version</notes>
        <packageUrl regex="true">^pkg:npm/openid-client@.*$</packageUrl>
        <vulnerabilityName>1075</vulnerabilityName>
    </suppress>
    
    <!-- Docker Base Image -->
    <suppress>
        <notes>Alpine Linux base image - Using latest security updates</notes>
        <packageUrl regex="true">^pkg:alpine/.*$</packageUrl>
        <cve>CVE-2023-42363</cve>
    </suppress>
    
    <!-- Transitive Dependencies -->
    <suppress>
        <notes>Webpack - Transitive dependency from Next.js</notes>
        <packageUrl regex="true">^pkg:npm/webpack@.*$</packageUrl>
        <cve>CVE-2023-28154</cve>
    </suppress>
    
    <suppress>
        <notes>semver - Transitive dependency, not exposed to user input</notes>
        <packageUrl regex="true">^pkg:npm/semver@.*$</packageUrl>
        <cve>CVE-2022-25883</cve>
    </suppress>
    
    <!-- False Positives -->
    <suppress>
        <notes>lodash - Not using vulnerable functions</notes>
        <packageUrl regex="true">^pkg:npm/lodash@.*$</packageUrl>
        <cve>CVE-2021-23337</cve>
    </suppress>
    
    <suppress>
        <notes>express - Not using body-parser vulnerable to prototype pollution</notes>
        <packageUrl regex="true">^pkg:npm/express@.*$</packageUrl>
        <cve>CVE-2022-29078</cve>
    </suppress>
    
    <!-- Testing Libraries -->
    <suppress until="2025-12-31">
        <notes>Testing libraries - Development environment only, suppressed until 2025</notes>
        <packageUrl regex="true">^pkg:npm/@testing-library/.*$</packageUrl>
        <cve>CVE-2023-26136</cve>
    </suppress>
    
    <!-- Build Tools -->
    <suppress>
        <notes>ESLint - Build time tool only</notes>
        <packageUrl regex="true">^pkg:npm/eslint@.*$</packageUrl>
        <vulnerabilityName>1088</vulnerabilityName>
    </suppress>
    
    <!-- Kubernetes Helm Charts -->
    <suppress>
        <notes>Helm chart templates - Not executable code</notes>
        <filePath regex="true">.*helm/.*\.yaml$</filePath>
        <cve>CVE-2023-25165</cve>
    </suppress>
</suppressions>